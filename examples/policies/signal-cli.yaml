tools:
  signal-cli:
    type: http
    upstream: "http://127.0.0.1:18080"

    # Allow only safe read/send operations
    jsonrpc_allow_methods:
      - send
      - receive
      - listMessages
      - version

    # Deny dangerous operations
    jsonrpc_deny_methods:
      - deleteEverything
      - removeAccount
      - unregister

    # Filter on phone numbers - RESTRICT TO ONLY +12246192888
    jsonrpc_param_filters:
      send:
        field: "recipientNumber"
        allow_patterns:
          - "+12246192888"     # Only allow sending to this number
        deny_patterns: []

    rate_limit:
      max_requests: 100  # Max 100 messages per minute
      window_secs: 60

    timeout_secs: 30

    audit:
      enabled: true
      log_body: false  # Set to true to log full JSON-RPC requests (debug mode)
      redact_patterns:
        - "recipientNumber"  # Optionally redact phone numbers in audit logs
