tools:
  op:
    type: cli
    binary: /usr/bin/op

    # Allow read-only operations
    argv_allow_patterns:
      - "item get *"
      - "item list*"
      - "vault list*"
      - "document get *"
      - "--version"
      - "whoami"

    # Deny write/destructive operations
    argv_deny_patterns:
      - "item create *"
      - "item edit *"
      - "item delete *"
      - "vault create *"
      - "vault delete *"
      - "document create *"
      - "document edit *"
      - "document delete *"

    # Inject HOME so op can find its config/session files when run by the server
    env_inject:
      HOME: "/home/<your-username>"

    timeout_secs: 30

    audit:
      enabled: true
      log_argv: true
      redact_patterns:
        - "--session"
